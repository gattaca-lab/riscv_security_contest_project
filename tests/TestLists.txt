add_debugger_test(debugger_sanity debugger/debugger_sanity.s
                  ${CMAKE_SOURCE_DIR}/tests/debugger/sanity.input
                  --driver_arg=--repl)

test_add(basic_mem         basic/mem.py)
test_add(store_byte_issue  basic/store_byte_issue.py)

test_add(asm_timer              asm/timer.s)
test_add(asm_uart               asm/uart.s)
test_add(asm_uart_collapse      asm/uart_collapse.s)
test_add(asm_sb                 asm/sb.s)
test_add(asm_lb                 asm/lb.s)
test_add(asm_sb_ret             asm/sb_ret.s)
test_add(asm_remu               asm/remu.s NIGHTLY)
test_add(asm_remu_illegal       asm/remu_illegal.s NIGHTLY)

test_add(asm_tags               asm/tags/tags.s)
test_add(asm_tags_stlt_storage  asm/tags/stlt_storage.s)
test_add(asm_tags_ram_border    asm/tags/ram_border.s)
test_add(asm_tags_pend_clear    asm/tags/pend_clear.s)
test_add(asm_tags_sec_leak      asm/tags/sec_leak.s NIGHTLY)
test_add(asm_tags_sec_corrupt   asm/tags/sec_corrupt.s NIGHTLY)
test_add(asm_tags_mismatch_if_icd   asm/tags/mismatch_if_icd.s)
test_add(asm_tags_mismatch_if_ice   asm/tags/mismatch_if_ice.s)
test_add(asm_tags_mismatch_sw   asm/tags/mismatch_sw.s)
test_add(asm_tags_mismatch_lw   asm/tags/mismatch_lw.s)
test_add(asm_tags_match_s_l     asm/tags/match_s_l.s)
test_add(asm_tags_disabled_stlt asm/tags/disabled_stlt.s)

test_add(asm_mext_mult          asm/mext/mult.s)
test_add(asm_mext_mulh          asm/mext/mulh.s)
test_add(asm_mext_mulhsu        asm/mext/mulhsu.s)
test_add(asm_mext_mulhu         asm/mext/mulhu.s)

test_add(asm_mext_div           asm/mext/div.s)
test_add(asm_mext_divu          asm/mext/divu.s)
test_add(asm_mext_rem           asm/mext/rem.s)
test_add(asm_mext_remu          asm/mext/remu.s)
test_add(asm_mext_zero          asm/mext/zerodiv.s)

test_add(asm_csrr_vendorid      asm/csrr_vendor.s)
test_add(asm_csrw_vendorid      asm/csrw_vendor.s)
test_add(asm_csre_missing_csr   asm/csrr_missing.s)
test_add(asm_csrrw_small   asm/csrrw_compliance.s)
test_add(asm_csrrs_small   asm/csrrs_compliance.s)

test_add(c_basic             c/basic)

test_add(c_libc_exit_S       c/libc/exit_succ)
test_add(c_libc_exit_F       c/libc/exit_fail --driver_arg=--expect-failure)
test_add(c_libc_main_ret_S   c/libc/main_ret_succ)
test_add(c_libc_main_ret_F   c/libc/main_ret_fail --driver_arg=--expect-failure)
test_add(c_libc_printf4      c/libc/printf4)
test_add(c_libc_printf5      c/libc/printf5)
test_add(c_libc_printf_int   c/libc/printf_int)
test_add(c_libc_malloc       c/libc/malloc)
test_add(c_libc_memset       c/libc/memset)
test_add(c_libc_memcmp       c/libc/memcmp)
test_add(c_libc_printk       c/libc/printk)
test_add(c_libc_strcat       c/libc/strcat)
test_add(c_libc_strcpy       c/libc/strcpy)
test_add(c_libc_strlen       c/libc/strlen)
test_add(c_libc_strncat      c/libc/strncat NIGHTLY)
test_add(c_libc_strncpy      c/libc/strncpy NIGHTLY)
test_add(c_libc_strtoul      c/libc/strtoul NIGHTLY)

test_add(c_Slibc_s_malloc     c/libc_sec/s_malloc)
test_add(c_Slibc_s_free       c/libc_sec/s_free NIGHTLY)
test_add(c_Slibc_ns_malloc    c/libc_sec/ns_malloc)
test_add(c_Slibc_ns_free      c/libc_sec/ns_free)

test_add(c_isr_route_timer_base   c/libc/isr_route_timer_base)
test_add(c_isr_route_ialign_base  c/libc/isr_route_ialign_base)

test_add(c_fibonacci              c/fibo)

#I
set(COMPLIANCE_SOURCES_ROOT ${CMAKE_SOURCE_DIR}/tests/compliance/rv32i/src)
file(GLOB COMPLIANCE_TESTS "${COMPLIANCE_SOURCES_ROOT}/*.S")
foreach(file ${COMPLIANCE_TESTS})
    get_filename_component(NAME "${file}" NAME)
    test_add(compliance_rv32i_${NAME}  compliance/rv32i/src/${NAME})
endforeach()
#M
set(COMPLIANCE_SOURCES_ROOT ${CMAKE_SOURCE_DIR}/tests/compliance/rv32im/src)
file(GLOB COMPLIANCE_TESTS "${COMPLIANCE_SOURCES_ROOT}/*.S")
set(FAILED_TESTS  ""
                  "")
foreach(file ${COMPLIANCE_TESTS})
    get_filename_component(NAME "${file}" NAME)
    if (compliance_rv32im_${NAME} IN_LIST FAILED_TESTS)
        test_add(compliance_rv32im_${NAME}  compliance/rv32im/src/${NAME} NIGHTLY)
    else()
        test_add(compliance_rv32im_${NAME}  compliance/rv32im/src/${NAME})
    endif()

endforeach()
